Follow https://docs.espressif.com/projects/esp-idf/en/latest/esp32/get-started/windows-setup.html

when installing the idf tools install the 5.0.2 offline installer.

Add the espressif idf extension to vscode

Press control+shift+p and search esp-idf: welcome

On this page select configure extension and select use existing extension.

Use the default settings.

Next clone the repository to your system

Everything should be set to build/flash